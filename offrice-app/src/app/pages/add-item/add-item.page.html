<app-toolbar title="Nuovo Prodotto"></app-toolbar>

<ion-content [fullscreen]="true">

  <ion-card class="modern-card">
    <ion-card-content>

      <!-- Image Upload Section -->
      <div class="image-upload-container" (click)="addPhoto()">
        <div *ngIf="!tempImage" class="placeholder">
          <ion-icon [icon]="camera"></ion-icon>
          <p>Aggiungi foto</p>
        </div>
        <img *ngIf="tempImage" [src]="tempImage" class="preview-image" />
      </div>

      <!-- Form List -->
      <ion-list class="ion-no-padding">

        <ion-item lines="none">
          <ion-label position="stacked">Cosa aggiungi?</ion-label>
          <ion-input [(ngModel)]="itemForm.productName" placeholder="Es. Pasta, Latte..." required></ion-input>
        </ion-item>

        <ion-grid class="ion-no-padding">
          <ion-row>
            <ion-col size="6" style="padding-right: 6px;">
              <ion-item lines="none">
                <ion-label position="stacked">Quantità</ion-label>
                <ion-input type="number" [(ngModel)]="itemForm.quantity" placeholder="0" required></ion-input>
              </ion-item>
            </ion-col>
            <ion-col size="6" style="padding-left: 6px;">
              <ion-item lines="none">
                <ion-label position="stacked">Unità</ion-label>
                <ion-select [(ngModel)]="itemForm.unit" interface="popover">
                  <ion-select-option *ngFor="let u of units" [value]="u">{{u}}</ion-select-option>
                </ion-select>
              </ion-item>
            </ion-col>
          </ion-row>
        </ion-grid>

        <ion-item lines="none">
          <ion-label position="stacked">Note (Opzionale)</ion-label>
          <ion-textarea rows="3" [(ngModel)]="itemForm.description" placeholder="Scadenza, dettagli..."></ion-textarea>
        </ion-item>

      </ion-list>

      <!-- Error Message -->
      <div class="ion-margin-top" *ngIf="errorMessage">
        <ion-text color="danger" class="error-text">{{ errorMessage }}</ion-text>
      </div>

      <!-- Actions -->
      <div class="ion-margin-top">
        <ion-button expand="block" class="btn-save" (click)="saveItem()" [disabled]="saving">
          <ion-spinner *ngIf="saving" name="crescent"></ion-spinner>
          <span *ngIf="!saving">Aggiungi alla Dispensa</span>
          <span *ngIf="saving">Salvataggio...</span>
        </ion-button>

        <ion-button expand="block" fill="clear" class="btn-cancel" (click)="goToDashboard()" [disabled]="saving">
          Annulla
        </ion-button>
      </div>

    </ion-card-content>
  </ion-card>
</ion-content>